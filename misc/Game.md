---
layout: page
title: Game内建模块
parent: 杂项
---

* TOC
{:toc}


# Game

Game是Zeze内建模块。

## Online
基于角色的在线管理模块。提供给任意在线角色发送消息的接口。
主要功能跟Arch/Online差不多，这里不详细说明了。

## Bag
基于格子的包裹模块。支持堆叠，拆分，移动，合并等操作。

## Rank
在概念上，排行榜是对定义的数据进行排序。这种实现方式在大多数情况下都无法提供足够
的性能。有一种实现是每天用备份库排一次序。这种的缺点狠明显，更新不及时，而且在数
据量大时，仍然消耗大量计算资源。一般来说，排行榜只需要显示排在开头的少量数据，比
如前100名。所以有一种实现是在排行榜相关数据变更时，马上更新排行榜（快速判断是
否进榜）。对于只增长的数据，这种实现方式是完全正确的。对于可能变小的数据，有个缺
陷，当排到当前排行榜数据的末尾时，可能是不正确的。因为原来没进榜的数据可能比此时
末尾的大。这里一般用一个技巧，就是排行榜的个数在计算时比需求大些，比如1000个。
这样当它处于第1000个时，从计算数据中删除它。只要计算数据中的数量还剩的比100多，
仍然是正确的。如果比100还少，那么就显示少一些的数据，也不会出现玩家发现自己该
进榜而不在里面的问题。这种实现方式，排行榜的写操作很很多，而且概念上还是全局共享
的，需要额外的解决方案。

## ProviderDirectWithTransmit
Server之间直连处理模块的一个更具体实现，包含Transmit功能。
依赖ProviderImplementWithOnline。

## ProviderImplementWithOnline
Server处理来自Linkd转发的客户端请求模块的更具体实现，包含Online模块的实例，多了
一个处理（ProcessLinkBroken），处理来自Linkd的客户端连接断开的事件。
